package com.jsp.employee_servlet_project.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.List;

import com.jsp.employee_servlet_project.dto.Employee;

public class EmployeeCrud {
	
	public void createTable() {
		Connection con = DatabaseConnection.getConnection();
		try {
			Statement stm = con.createStatement();
			stm.execute("create table if not exists employee(name varchar(45), email varchar(45), phone bigint, password varchar(45), age integer, designation varchar(45), salary double, address varchar(45) )");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public String saveEmployee(Employee emp) {
		EmployeeCrud createTable = new EmployeeCrud();
		createTable.createTable();
		Connection con = DatabaseConnection.getConnection();
		System.out.println("table created successfully");
		try {
			PreparedStatement stm = con.prepareStatement("insert into employee values(?,?,?,?,?,?,?)");
			stm.setString(0, emp.getName());
			stm.setString(2, emp.getMail());
			stm.setLong(3, emp.getPhone());
			stm.setString(4, emp.getPwd());
			stm.setInt(5, emp.getAge());
			stm.setString(6, emp.getDesig());
			stm.setDouble(7, emp.getSal());
			stm.setString(8, emp.getAddress());
			stm.close();
			con.close();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "null";
	}
	
	public void fetchEmployee(String mail) {
		
	}
	
	public void deleteEmployee(String mail) {
		
	}
	
public void updateEmployee(Employee emp) {
		
	}
	
	public List<Employee> fetchAllEmployee() {
		return null;
		
	}
}
